!function(e){const t=e.ajax.bind(e),n=[];let r=0;function getMaxConcurrent(){return"number"==typeof e.ajax.maxConcurrent&&e.ajax.maxConcurrent>0?e.ajax.maxConcurrent:5}function processQueue(){for(;n.length&&r<getMaxConcurrent();){let{settings:e,resolve:o,reject:u}=n.shift();r++,console.debug("Processing AJAX request. Active requests:",r,"Queue length:",n.length,"Max concurrent:",getMaxConcurrent());const s="number"==typeof e.timeout?e.timeout:1e4,a=!1!==e.abortOnTimeout;!a&&"timeout"in e&&(e=Object.assign({},e),delete e.timeout);const c=t(e),i=new Promise(((e,t)=>{c.done(e).fail(((e,n,r)=>t({jqXHR:e,textStatus:n,errorThrown:r})))}));if(a){const e=new Promise(((e,t)=>{setTimeout((()=>{c&&c.abort&&(console.warn("Aborting XHR due to timeout"),c.abort()),t({timeout:!0,message:`Request timed out after ${s}ms`})}),s)}));Promise.race([i,e]).then((e=>o(e))).catch((e=>u(e))).finally((()=>{r--,processQueue()}))}else{let e=!1;setTimeout((()=>{e||(e=!0,u({timeout:!0,message:`Request timed out after ${s}ms`}))}),s),i.then((t=>{e||(e=!0,o(t))})).catch((t=>{e||(e=!0,u(t))})).finally((()=>{r--,processQueue()}))}}}e.ajax.maxConcurrent=5,e.ajax=function(r={}){if(!1===r.queue)return t(r);const o=e.Deferred(),u=new Promise(((e,t)=>{n.push({settings:r,resolve:e,reject:t}),processQueue()}));u.then((e=>o.resolve(e)),(e=>o.reject(e))),o.then=u.then.bind(u),o.catch=u.catch.bind(u),o.finally=u.finally.bind(u),o.promise=u;let s=!1;const a=o.catch;o.catch=function(){return s=!0,a.apply(this,arguments)};const c=o.fail;return o.fail=function(){return s=!0,c.apply(this,arguments)},setTimeout((()=>{s||u.catch((()=>{}))}),0),o},e.ajax.maxConcurrent=5}(jQuery);